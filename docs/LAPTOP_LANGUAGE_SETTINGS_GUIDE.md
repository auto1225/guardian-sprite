# λ…ΈνΈλ¶ μ•± μ–Έμ–΄ μ„¤μ • μ—°λ™ κ°€μ΄λ“

## κ°μ”

μ¤λ§νΈν° μ•±μ—μ„ μ„ νƒν• μ–Έμ–΄κ°€ λ…ΈνΈλ¶ μ•±μ—λ„ λ™μΌν•κ² μ μ©λμ–΄μ•Ό ν•©λ‹λ‹¤.
μ¤λ§νΈν° μ•±μ€ 17κ° μ–Έμ–΄λ¥Ό μ§€μ›ν•λ©°, AI κΈ°λ° μλ™ λ²μ—­ μ‹μ¤ν…μ„ μ‚¬μ©ν•©λ‹λ‹¤.

---

## 1. μ§€μ› μ–Έμ–΄ λ©λ΅

| # | μ½”λ“ | μ–Έμ–΄ | κµ­κΈ° |
|---|------|------|------|
| 1 | `ko` | ν•κµ­μ–΄ | π‡°π‡· |
| 2 | `en` | English | π‡Ίπ‡Έ |
| 3 | `ja` | ζ—¥ζ¬θ | π‡―π‡µ |
| 4 | `zh-CN` | η®€δ½“δΈ­ζ–‡ | π‡¨π‡³ |
| 5 | `zh-TW` | ηΉι«”δΈ­ζ–‡ | π‡Ήπ‡Ό |
| 6 | `es` | EspaΓ±ol | π‡π‡Έ |
| 7 | `fr` | FranΓ§ais | π‡«π‡· |
| 8 | `de` | Deutsch | π‡©π‡ |
| 9 | `pt` | PortuguΓs | π‡§π‡· |
| 10 | `ru` | Π ΡƒΡΡΠΊΠΈΠΉ | π‡·π‡Ί |
| 11 | `ar` | Ψ§Ω„ΨΉΨ±Ψ¨ΩΨ© | π‡Έπ‡¦ |
| 12 | `hi` | ΰ¤Ήΰ¤Ώΰ¤¨ΰ¥ΰ¤¦ΰ¥€ | π‡®π‡³ |
| 13 | `th` | ΰΉ„ΰΈ—ΰΈΆ | π‡Ήπ‡­ |
| 14 | `vi` | TiαΊΏng Viα»‡t | π‡»π‡³ |
| 15 | `id` | Bahasa Indonesia | π‡®π‡© |
| 16 | `tr` | TΓΌrkΓ§e | π‡Ήπ‡· |
| 17 | `it` | Italiano | π‡®π‡Ή |

---

## 2. μ–Έμ–΄ μμ‹  λ°©λ²•

### 2-1. λΈλ΅λ“μΊμ¤νΈ μμ‹  (μ‹¤μ‹κ°„)

μ¤λ§νΈν°μ—μ„ μ–Έμ–΄ λ³€κ²½ μ‹ `settings_updated` λΈλ΅λ“μΊμ¤νΈκ°€ μ „μ†΅λ©λ‹λ‹¤.

```typescript
// μ±„λ„: device-commands-{deviceId}
// μ΄λ²¤νΈ: settings_updated
// νμ΄λ΅λ“ μμ‹:
{
  device_id: "uuid-here",
  settings: {
    language: "ja"  // λ³€κ²½λ μ–Έμ–΄ μ½”λ“
    // λ‹¤λ¥Έ μ„¤μ •λ„ ν•¨κ» μ¬ μ μμ
  }
}
```

**μμ‹  μ½”λ“ μμ‹:**
```typescript
const channel = supabase.channel(`device-commands-${deviceId}`);
channel.on("broadcast", { event: "settings_updated" }, (payload) => {
  const lang = payload.payload?.settings?.language;
  if (lang) {
    applyLanguage(lang); // μ–Έμ–΄ λ³€κ²½ μ μ©
  }
});
channel.subscribe();
```

### 2-2. DBμ—μ„ μ½κΈ° (μ•± μ‹μ‘ μ‹)

```typescript
const { data } = await supabase
  .from("devices")
  .select("metadata")
  .eq("id", deviceId)
  .single();

const lang = data?.metadata?.language || "ko"; // κΈ°λ³Έκ°’: ν•κµ­μ–΄
applyLanguage(lang);
```

---

## 3. λ²μ—­ μ‹μ¤ν… κµ¬ν„

### 3-1. μ •μ  λ²μ—­ (ko, en)

ν•κµ­μ–΄μ™€ μμ–΄λ” JSON νμΌμ„ μ§μ ‘ λ²λ“¤ν•©λ‹λ‹¤.

```
src/i18n/locales/ko.json  β† μ¤λ§νΈν° μ•±κ³Ό λ™μΌν• κ³µν†µ ν‚¤ + λ…ΈνΈλ¶ μ „μ© ν‚¤
src/i18n/locales/en.json  β† μ¤λ§νΈν° μ•±κ³Ό λ™μΌν• κ³µν†µ ν‚¤ + λ…ΈνΈλ¶ μ „μ© ν‚¤
```

### 3-2. λ™μ  λ²μ—­ (λ‚λ¨Έμ§€ 15κ° μ–Έμ–΄)

μ¤λ§νΈν° μ•±κ³Ό λ™μΌν• λ°©μ‹μΌλ΅ AI λ²μ—­ Edge Functionμ„ νΈμ¶ν•©λ‹λ‹¤.

```typescript
const { data, error } = await supabase.functions.invoke("translate-i18n", {
  body: {
    sourceJson: koJson,     // ν•κµ­μ–΄ μ›λ³Έ JSON
    targetLang: "ja"         // λ€μƒ μ–Έμ–΄ μ½”λ“
  }
});

if (data?.translation) {
  i18n.addResourceBundle("ja", "translation", data.translation, true, true);
  i18n.changeLanguage("ja");
  // localStorageμ— μΊμ‹
  localStorage.setItem("meercop_i18n_ja", JSON.stringify(data.translation));
}
```

### 3-3. μΊμ‹ κ΄€λ¦¬

```typescript
const CACHE_PREFIX = "meercop_i18n_";
const CACHE_VERSION_KEY = "meercop_i18n_version";
const CURRENT_VERSION = "3"; // μ¤λ§νΈν° μ•±κ³Ό λ™μΌν•κ² μ μ§€

// μΊμ‹ μ½κΈ°
function getCachedTranslation(lang: string) {
  const version = localStorage.getItem(CACHE_VERSION_KEY);
  if (version !== CURRENT_VERSION) {
    // λ²„μ „ λ¶μΌμΉ β†’ λ¨λ“  μΊμ‹ μ‚­μ 
    clearAllCaches();
    localStorage.setItem(CACHE_VERSION_KEY, CURRENT_VERSION);
    return null;
  }
  const cached = localStorage.getItem(`${CACHE_PREFIX}${lang}`);
  return cached ? JSON.parse(cached) : null;
}
```

> β οΈ `CURRENT_VERSION`μ€ μ¤λ§νΈν° μ•±μ `src/lib/dynamicTranslation.ts`μ™€ λ°λ“μ‹ λ™μΌν•κ² μ μ§€ν•μ„Έμ”.  
> μ¤λ§νΈν° μ•±μ—μ„ ko.jsonμ— μƒ λ¬Έμ¥μ„ μ¶”κ°€ν•λ©΄ λ²„μ „μ΄ μ¬λΌκ°€λ©°, λ…ΈνΈλ¶ μ•±λ„ κ°™μ€ λ²„μ „μΌλ΅ μ¬λ ¤μ•Ό μ¬λ²μ—­λ©λ‹λ‹¤.

---

## 4. λ…ΈνΈλ¶ μ „μ© λ²μ—­ ν‚¤

λ…ΈνΈλ¶ μ•±μ—λ§ ν•„μ”ν• ν‚¤λ” `laptop.*` λ„¤μ„μ¤νμ΄μ¤μ— μ¶”κ°€ν•©λ‹λ‹¤.  
μ΄ ν‚¤λ“¤μ€ ko.json, en.jsonμ— μ§μ ‘ μ‘μ„±ν•κ³ , AI λ²μ—­ μ‹ ν•¨κ» λ²μ—­λ©λ‹λ‹¤.

```json
{
  "laptop": {
    "alarmScreen": {
      "title": "β οΈ κ²½λ³΄ λ°μƒ",
      "enterPin": "λΉ„λ°€λ²νΈλ¥Ό μ…λ ¥ν•μ„Έμ”",
      "wrongPin": "λΉ„λ°€λ²νΈκ°€ ν‹€λ Έμµλ‹λ‹¤",
      "dismissed": "κ²½λ³΄κ°€ ν•΄μ λμ—μµλ‹λ‹¤"
    },
    "lockScreen": {
      "title": "ν™”λ©΄μ΄ μ κ²Όμµλ‹λ‹¤",
      "lockedBy": "μ›κ²©μΌλ΅ μ κΉ€",
      "unlockPrompt": "μ κΈμ„ ν•΄μ ν•λ ¤λ©΄ κ΄€λ¦¬μμ—κ² λ¬Έμν•μ„Έμ”"
    },
    "messagePopup": {
      "title": "μ›κ²© λ©”μ‹μ§€",
      "from": "κ΄€λ¦¬μλ΅λ¶€ν„°"
    },
    "monitoring": {
      "started": "κ°μ‹κ°€ μ‹μ‘λμ—μµλ‹λ‹¤",
      "stopped": "κ°μ‹κ°€ μ¤‘μ§€λμ—μµλ‹λ‹¤"
    },
    "serial": {
      "enterSerial": "μ‹λ¦¬μ–Ό λ„λ²„λ¥Ό μ…λ ¥ν•μ„Έμ”",
      "invalidSerial": "μ ν¨ν•μ§€ μ•μ€ μ‹λ¦¬μ–Όμ…λ‹λ‹¤",
      "registered": "κΈ°κΈ°κ°€ λ“±λ΅λμ—μµλ‹λ‹¤"
    }
  }
}
```

---

## 5. UI/UX λ””μμΈ κ°€μ΄λ“

### 5-1. λ…ΈνΈλ¶ μ•±μ—μ„λ” μ–Έμ–΄ μ„¤μ • UI λ¶ν•„μ”

- μ–Έμ–΄ λ³€κ²½μ€ **μ¤λ§νΈν° μ•±μ—μ„λ§** μν–‰ν•©λ‹λ‹¤.
- λ…ΈνΈλ¶ μ•±μ€ μμ‹ ν• μ–Έμ–΄λ¥Ό μλ™ μ μ©λ§ ν•λ©΄ λ©λ‹λ‹¤.
- λ…ΈνΈλ¶ μ•±μ— λ³„λ„ μ–Έμ–΄ μ„ νƒ UIλ¥Ό λ§λ“¤μ§€ λ§μ„Έμ”.

### 5-2. μ–Έμ–΄ λ³€κ²½ μ‹ UI μ „ν™ λ™μ‘

```
[μ¤λ§νΈν°μ—μ„ μ–Έμ–΄ λ³€κ²½]
        β†“
[broadcast μμ‹ ]
        β†“
[λ΅λ”© ν‘μ‹] β† λ²μ—­ λ΅λ“ μ¤‘ ν† μ¤νΈ λλ” μ¤ν”Όλ„ (1~3μ΄)
        β†“
[UI μ „μ²΄ κ°±μ‹ ] β† λ¨λ“  ν…μ¤νΈκ°€ μƒ μ–Έμ–΄λ΅ λ³€κ²½
```

**λ΅λ”© μ¤‘ ν‘μ‹ (κ¶μ¥):**
```typescript
// μ–Έμ–΄ λ³€κ²½ μ‹ μ§§μ€ ν† μ¤νΈ ν‘μ‹
toast({
  title: "π",
  description: `${langLabel}...`, // μ: "ζ—¥ζ¬θ..."
  duration: 2000
});
```

### 5-3. RTL (Right-to-Left) μ§€μ›

μ•„λμ–΄(`ar`) μ„ νƒ μ‹ ν…μ¤νΈ λ°©ν–¥μ„ RTLλ΅ λ³€κ²½ν•΄μ•Ό ν•©λ‹λ‹¤.

```typescript
function applyLanguage(lang: string) {
  i18n.changeLanguage(lang);
  
  // RTL μ²λ¦¬
  const isRTL = lang === "ar";
  document.documentElement.dir = isRTL ? "rtl" : "ltr";
  document.documentElement.lang = lang;
}
```

**CSS RTL λ€μ‘:**
```css
/* RTL λ¨λ“μ—μ„ λ μ΄μ•„μ›ƒ λ°μ „ */
[dir="rtl"] .flex-row {
  flex-direction: row-reverse;
}

[dir="rtl"] .text-left {
  text-align: right;
}

/* λλ” Tailwind CSS μ‚¬μ© μ‹ */
/* rtl: μ ‘λ‘μ‚¬ ν™μ© */
```

### 5-4. κ²½λ³΄ ν™”λ©΄ λ‹¤κµ­μ–΄

κ²½λ³΄ ν™”λ©΄μ€ κ°€μ¥ μ¤‘μ”ν• ν™”λ©΄μ΄λ―€λ΅ λ°λ“μ‹ λ²μ—­μ΄ μ μ©λμ–΄μ•Ό ν•©λ‹λ‹¤.

```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                             β”‚
β”‚      β οΈ θ­¦ε ±γη™Ίη”γ—γΎγ—γ     β”‚  β† laptop.alarmScreen.title
β”‚                             β”‚
β”‚   γƒ‘γ‚Ήγƒ―γƒΌγƒ‰γ‚’ε…¥ε›γ—γ¦γγ γ•γ„   β”‚  β† laptop.alarmScreen.enterPin
β”‚                             β”‚
β”‚      β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”    β”‚
β”‚      β”‚  β— β— β— β—        β”‚    β”‚  β† PIN μ…λ ¥
β”‚      β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”    β”‚
β”‚                             β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

### 5-5. μ κΈ ν™”λ©΄ λ‹¤κµ­μ–΄

```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                             β”‚
β”‚     π”’ η”»ιΆγγƒ­γƒƒγ‚―γ•γ‚γΎγ—γ   β”‚  β† laptop.lockScreen.title
β”‚                             β”‚
β”‚      γƒγƒΆγƒΌγƒγ§γƒ­γƒƒγ‚―γ•γ‚γΎγ—γ  β”‚  β† laptop.lockScreen.lockedBy
β”‚                             β”‚
β”‚  γƒ­γƒƒγ‚―θ§£ι™¤γ―η®΅η†θ€…γ«γε•γ„εγ‚γ› β”‚  β† laptop.lockScreen.unlockPrompt
β”‚     γγ γ•γ„                  β”‚
β”‚                             β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

### 5-6. λ©”μ‹μ§€ νμ—… λ‹¤κµ­μ–΄

```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚  π“© γƒγƒΆγƒΌγƒγƒ΅γƒƒγ‚»γƒΌγ‚Έ         β”‚  β† laptop.messagePopup.title
β”‚  β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€  β”‚
β”‚                             β”‚
β”‚  "μλ¦¬ λΉ„μ›μ£Όμ„Έμ”"             β”‚  β† μ‚¬μ©μ μ…λ ¥ λ©”μ‹μ§€ (λ²μ—­ X)
β”‚                             β”‚
β”‚  η®΅η†θ€…γ‹γ‚‰                   β”‚  β† laptop.messagePopup.from
β”‚              [ OK ]         β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

> β οΈ μ‚¬μ©μκ°€ μ…λ ¥ν• λ©”μ‹μ§€ λ³Έλ¬Έμ€ λ²μ—­ν•μ§€ μ•μµλ‹λ‹¤. UI ν”„λ μ„λ§ λ²μ—­ν•©λ‹λ‹¤.

### 5-7. μ‹λ¦¬μ–Ό μ…λ ¥ ν™”λ©΄ λ‹¤κµ­μ–΄

```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                             β”‚
β”‚  MeerCOP                    β”‚
β”‚                             β”‚
β”‚  γ‚·γƒγ‚Άγƒ«γƒγƒ³γƒγƒΌγ‚’ε…¥ε›γ—γ¦     β”‚  β† laptop.serial.enterSerial
β”‚  γγ γ•γ„                    β”‚
β”‚                             β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”    β”‚
β”‚  β”‚ XXXX-XXXX-XXXX      β”‚    β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”    β”‚
β”‚                             β”‚
β”‚       [ η™»ι² ]              β”‚  β† common.register
β”‚                             β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

---

## 6. ν°νΈ κ³ λ ¤μ‚¬ν•­

μΌλ¶€ μ–Έμ–΄λ” νΉμ ν°νΈκ°€ ν•„μ”ν•  μ μμµλ‹λ‹¤:

| μ–Έμ–΄ | κ¶μ¥ ν°νΈ | λΉ„κ³  |
|------|-----------|------|
| `ko` | Pretendard, Noto Sans KR | κΈ°λ³Έ |
| `ja` | Noto Sans JP | μΌλ³Έμ–΄ ν•μ |
| `zh-CN` | Noto Sans SC | κ°„μ²΄ μ¤‘κµ­μ–΄ |
| `zh-TW` | Noto Sans TC | λ²μ²΄ μ¤‘κµ­μ–΄ |
| `ar` | Noto Sans Arabic | RTL + μ—°κ²° λ¬Έμ |
| `hi` | Noto Sans Devanagari | νλ””μ–΄ |
| `th` | Noto Sans Thai | νƒκµ­μ–΄ μ„±μ΅° λ¶€νΈ |

**μ›Ή ν°νΈ λ΅λ”© (κ¶μ¥):**
```css
/* Google Fontsμ—μ„ ν•„μ”ν• μ–Έμ–΄λ³„ ν°νΈλ§ λ΅λ“ */
@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP&family=Noto+Sans+SC&family=Noto+Sans+TC&family=Noto+Sans+Arabic&display=swap');

body {
  font-family: 'Pretendard', 'Noto Sans JP', 'Noto Sans SC', 'Noto Sans TC', 
               'Noto Sans Arabic', 'Noto Sans Devanagari', 'Noto Sans Thai', 
               system-ui, sans-serif;
}
```

> π’΅ μ‹μ¤ν… ν°νΈλ΅ λ€λ¶€λ¶„ μ»¤λ²„λλ―€λ΅, μ›Ή ν°νΈλ” ν‘μ‹κ°€ κΉ¨μ§€λ” κ²½μ°μ—λ§ μ¶”κ°€ν•μ„Έμ”.

---

## 7. κµ¬ν„ μ²΄ν¬λ¦¬μ¤νΈ

- [ ] `settings_updated` λΈλ΅λ“μΊμ¤νΈμ—μ„ `language` ν‚¤ μμ‹  μ²λ¦¬
- [ ] μ•± μ‹μ‘ μ‹ `devices.metadata.language` μ½μ–΄μ„ μ΄κΈ° μ–Έμ–΄ μ„¤μ •
- [ ] μ •μ  λ²μ—­ νμΌ (ko.json, en.json) μ— λ…ΈνΈλ¶ μ „μ© ν‚¤ μ¶”κ°€
- [ ] `translate-i18n` Edge Function νΈμ¶λ΅ λ™μ  λ²μ—­ κµ¬ν„
- [ ] localStorage μΊμ‹ + λ²„μ „ κ΄€λ¦¬ (`CURRENT_VERSION = "3"`)
- [ ] μ•„λμ–΄ RTL λ μ΄μ•„μ›ƒ λ€μ‘
- [ ] κ²½λ³΄ ν™”λ©΄ λ‹¤κµ­μ–΄ μ μ©
- [ ] μ κΈ ν™”λ©΄ λ‹¤κµ­μ–΄ μ μ©
- [ ] λ©”μ‹μ§€ νμ—… λ‹¤κµ­μ–΄ μ μ©
- [ ] μ‹λ¦¬μ–Ό μ…λ ¥ ν™”λ©΄ λ‹¤κµ­μ–΄ μ μ©
- [ ] μ–Έμ–΄ λ³€κ²½ μ¤‘ λ΅λ”© ν”Όλ“λ°± ν‘μ‹
- [ ] ν•„μ” μ‹ νΉμ μ–Έμ–΄ ν°νΈ λ΅λ“
